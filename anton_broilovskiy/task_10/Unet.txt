Unet
Теперь пришло время поговорить о сетях, решающих другую задачу, а именно - задачу сегментации.
Сегодня мы познакомимся с архитектурой named Unet, узнаем истоию её появления, затем поговорим о самой архитектуре и, в заключении, как всегда, посмотрим на её плюсы и минусы.

Эта архитетура была разработана студентами из немецкого биологического университета for Biomedical Image Segmentation. И впервые была использована в соревнованиях ISBI в 2015 году.

Основная идея архитектуры заключается в замене обычных операций пулинга, на upsampling - это операция, обычно представляет из себя upконволюцию и нужна для увеличения изображени. Архитектуру сети можно разделить на 2 части: contracting path это часть, в которой происходит сжатие изображения, и expansive path.
Теперь рассмотрим эти части по-подробнее:
Contracting path представляет собой обычную сверточную сеть, в которой чередуются конволюционные слои с ядром размера 3х3 и с maxpooling'ом размера 2х2 и страйдом 2, который каждый раз уменьшает изобаржение в 2 раза. По мере уменьшения размера изображения увеличивается количество фильтров, тем самым позволяя сохранить какую-то конекстную информацию.

Expansive path это часть в которой происходит увеличение размера фильтров, и операция pooling'a заменяется на Upcomvolution-операция, обратная конволюции. Из-за того, что размер карт увеличивается, необходимо уменьшать количество фильтров, для того, чтобы переносить информацию из канальной размерности на сами фильтры. Для создания большего контекста "" high resolution features from the contracting path are combined with the upsampled output. A successive convolution layer can then learn to assemble a more precise output based on this information. Для правильного выполнения опреации конкатенации, фильтры большего размера обрезаются по краям до нужного размера. В конце выполняется конволюция 1х1 для изменения числа фильтров под количество классов.

Благодоря тому, что конволюции, во всей сети выполняются без применения какого либо padding'a
выходное изображение получается меньше, чем входное. Авторы статьи рекомендуют отображать изображение и пропускать его через сеть еще раз. Это сделано для того, чтобы в исходной маске содержались только те пиксели, которые контекстно связаны с релаьным изображением. "" the segmentation map only contains the pixels, for which the full context is available in the input image. ""

Отдельное внимание стоит уделить способу обучения сети. Изначально архитектура создавалась для решения специфичной задачи, в которой очень важно было правильно выделять границы объектов. Для этого авторы использовали как функцию потерь взвешенную кроссэнтропию. И для обучения рассчитали вес для каждого пикселя по вот такой формуле, которая делает вес пикселя больше, чем ближе к границе класса он расположен.

Сейчас настало время посмотреть на плюсы и минусы архитектуры:
К плюсам можно отнести:
	* Это fully convolutional network в которой нет ни одного полносвязного слоя, из-за этого в сети не очень много параметров, а значит она может быстро обучаться(Обучали всего 10 дней)
	* Для сети не нужно много данных, достаточно небольшого набора аугментированных данных
	* Skipconnections позволяют учитывать низкоуровненвые признаки, которые были выявлены на ранних слоях.
	* Skipconnections так же способствуют распространению градиентов.???

К недостаткам:
	* Использование только конволюций 3х3 не позволяет нормально отделять большие объекты, из-за маленького receptive field'a.

Сегодня мы поговорили о такой важной архитектуре как Unet, узнали, что благодоря специфичному лоссу она может хорошо различать границу между классами, но хуже работает с большими объектами из-за маленького Receptive field'a.
 ""in the upsampling part we have also a large number of feature channels, which allow the network to propagate context information to higher resolution layers.""




* про скип коннекшены
* про специальный лосс
* Плюсы и минусы / заключение